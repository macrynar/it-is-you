<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>It Is You - Testy Psychometryczne</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bg-deep':         '#030014',
                        'bg-surface':      '#0f0728',
                        'neon-primary':    '#7000ff',
                        'neon-cyan':       '#00f0ff',
                        'neon-pink':       '#ff005c',
                        'brand-primary':   '#7000ff',
                        'brand-secondary': '#00f0ff',
                        'brand-accent':    '#ff005c',
                        'bg-main':         '#030014',
                        'status-success':  '#10b981',
                        'status-danger':   '#ff005c',
                        'text-main':       '#f8fafc',
                        'text-muted':      '#94a3b8',
                    },
                    boxShadow: {
                        'glow-primary':    '0 0 20px -5px rgba(112,0,255,0.5)',
                        'glow-primary-lg': '0 0 40px -5px rgba(112,0,255,0.6)',
                        'glow-cyan':       '0 0 20px -5px rgba(0,240,255,0.5)',
                        'glow-pink':       '0 0 20px -5px rgba(255,0,92,0.5)',
                        'glow-danger':     '0 0 20px -5px rgba(255,0,92,0.5)',
                    },
                    backgroundImage: {
                        'neural-gradient': 'radial-gradient(circle at 50% 0%, #2a1b5e 0%, transparent 60%), radial-gradient(circle at 100% 0%, #1a0b38 0%, transparent 40%)',
                    },
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 1; }
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        @keyframes blink {
            0%, 90%, 100% { opacity: 1; transform: scale(1); }
            95% { opacity: 0.3; transform: scale(0.5); }
        }
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.3), 0 0 40px rgba(139, 92, 246, 0.1); }
            50% { box-shadow: 0 0 30px rgba(139, 92, 246, 0.5), 0 0 60px rgba(139, 92, 246, 0.2); }
        }
        
        :root {
            --bg-deep:      #030014;
            --bg-surface:   #0f0728;
            --neon-primary: #7000ff;
            --neon-cyan:    #00f0ff;
            --neon-pink:    #ff005c;
            --glass-border: rgba(255,255,255,0.08);
            --glass-shine:  rgba(255,255,255,0.10);
        }

        body {
            background-color: var(--bg-deep);
            background-image:
                radial-gradient(circle at 50% 0%, #2a1b5e 0%, transparent 60%),
                radial-gradient(circle at 100% 0%, #1a0b38 0%, transparent 40%),
                radial-gradient(circle at 0% 80%, #0d0626 0%, transparent 50%);
            background-attachment: fixed;
        }
        
        .grid-bg {
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        
        /* Neural Glass 2.0 ‚Äî card-neural & glass-card alias */
        .card-neural, .glass-card {
            position: relative;
            overflow: hidden;
            background: linear-gradient(180deg, rgba(20,10,40,0.75) 0%, rgba(10,5,20,0.45) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 4px 24px -1px rgba(0,0,0,0.35), inset 0 1px 0 0 var(--glass-shine);
            transition: border-color 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;
        }

        .card-neural::before, .glass-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(112,0,255,0.04) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        .card-neural:hover, .glass-card:hover {
            border-color: rgba(112, 0, 255, 0.35);
            box-shadow:
                0 0 40px -8px rgba(112,0,255,0.22),
                0 8px 32px -8px rgba(0,0,0,0.4),
                inset 0 1px 0 0 rgba(255,255,255,0.18);
            transform: translateY(-3px);
        }

        /* Test-specific hover accents */
        .glass-card.test-hexaco:hover,
        .glass-card.test-strengths:hover,
        .glass-card.test-career:hover,
        .glass-card.test-values:hover {
            border-color: rgba(112, 0, 255, 0.4);
            box-shadow: 0 0 40px -8px rgba(112,0,255,0.3), inset 0 1px 0 0 rgba(255,255,255,0.18);
        }

        .glass-card.test-enneagram:hover {
            border-color: rgba(0, 240, 255, 0.35);
            box-shadow: 0 0 40px -8px rgba(0,240,255,0.25), inset 0 1px 0 0 rgba(255,255,255,0.18);
        }

        .glass-card.test-dark-triad:hover {
            border-color: rgba(255, 0, 92, 0.35);
            box-shadow: 0 0 40px -8px rgba(255,0,92,0.25), inset 0 1px 0 0 rgba(255,255,255,0.18);
        }

        .glass-card-active { /* default state is clean */ }

        .glass-card-locked {
            opacity: 0.55;
            position: relative;
        }

        .glass-card-locked::after {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.45);
            backdrop-filter: blur(4px);
            border-radius: 1rem;
            pointer-events: none;
        }

        .glass-card-locked:hover {
            transform: none;
            border-color: var(--glass-border);
            box-shadow: none;
        }
        
        .neon-badge {
            background: rgba(100,116,139,0.12);
            border: 1px solid rgba(100,116,139,0.2);
            color: #94a3b8;
            font-size: 0.6rem;
            padding: 0.2rem 0.65rem;
            border-radius: 0.35rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.07em;
        }

        .neon-badge-success {
            background: rgba(16,185,129,0.12);
            border: 1px solid rgba(16,185,129,0.25);
            color: #6ee7b7;
        }
        
        .brand-font {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            letter-spacing: -0.02em;
        }
        
        .card-icon-wrapper {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.07);
            transition: all 0.3s ease;
        }

        .glass-card:hover .card-icon-wrapper,
        .card-neural:hover .card-icon-wrapper {
            background: rgba(112,0,255,0.12);
            border-color: rgba(112,0,255,0.3);
        }
        
        /* Theme Toggle Animation */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 32px;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            background: rgba(15, 7, 40, 0.9);
            border-color: rgba(112, 0, 255, 0.5);
        }

        .theme-toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #7000ff, #00f0ff);
            border-radius: 50%;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(112, 0, 255, 0.5);
        }
        
        .theme-toggle.light .theme-toggle-slider {
            transform: translateX(28px);
            background: linear-gradient(135deg, #F59E0B, #EAB308);
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.4);
        }
        
        .theme-icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            transition: opacity 0.3s ease;
        }
        
        .theme-icon-moon {
            left: 8px;
            opacity: 1;
        }
        
        .theme-icon-sun {
            right: 8px;
            opacity: 0.4;
        }
        
        .theme-toggle.light .theme-icon-moon {
            opacity: 0.4;
        }
        
        .theme-toggle.light .theme-icon-sun {
            opacity: 1;
        }
        
        /* Light Mode Styles */
        body.light-mode {
            background: #F8FAFC;
            background-image: 
                radial-gradient(at 50% 0%, rgba(139, 92, 246, 0.08) 0%, transparent 50%),
                radial-gradient(at 0% 50%, rgba(59, 130, 246, 0.05) 0%, transparent 50%);
            color: #0F172A;
        }
        
        body.light-mode .grid-bg {
            background-image: 
                linear-gradient(rgba(0, 0, 0, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.02) 1px, transparent 1px);
        }
        
        body.light-mode nav {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(0, 0, 0, 0.1);
        }
        
        body.light-mode .glass-card {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(0, 0, 0, 0.1);
            color: #0F172A;
        }
        
        body.light-mode .glass-card:hover {
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(139, 92, 246, 0.3);
        }
        
        body.light-mode .text-white {
            color: #0F172A !important;
        }
        
        body.light-mode .text-slate-300,
        body.light-mode .text-slate-400 {
            color: #475569 !important;
        }
        
        body.light-mode .text-slate-500 {
            color: #64748B !important;
        }
        
        body.light-mode .text-slate-600 {
            color: #475569 !important;
        }
        
        body.light-mode .bg-slate-800\/50,
        body.light-mode .bg-slate-900\/40 {
            background: rgba(241, 245, 249, 0.8) !important;
        }
        
        body.light-mode .border-white\/10,
        body.light-mode .border-slate-700 {
            border-color: rgba(0, 0, 0, 0.1) !important;
        }
        
        body.light-mode .bg-black\/30 {
            background: rgba(255, 255, 255, 0.8) !important;
        }

        /* Neural Glass 2.0 ‚Äî btn-neural (CDN Tailwind doesn't know this class) */
        .btn-neural {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            font-size: 0.875rem;
            color: #fff;
            background: linear-gradient(90deg, #5b21b6 0%, #7c3aed 100%);
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 0 20px -5px rgba(124,58,237,0.55), inset 0 1px 0 0 rgba(255,255,255,0.2);
            cursor: pointer;
            transition: all 0.25s ease;
            white-space: nowrap;
            text-decoration: none;
        }
        .btn-neural:hover {
            background: linear-gradient(90deg, #6d28d9 0%, #8b5cf6 100%);
            box-shadow: 0 0 35px -5px rgba(124,58,237,0.75), inset 0 1px 0 0 rgba(255,255,255,0.25);
            transform: translateY(-1px);
        }
        .btn-neural:active { transform: translateY(0); }
    </style>
</head>
<body class="min-h-screen text-white grid-bg">

    <!-- NAVIGATION -->
    <nav class="border-b border-white/5 bg-bg-surface/80 backdrop-blur-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <a href="https://it-is-you1.vercel.app/" class="flex items-center gap-3 group">
                    <div class="relative w-10 h-10 flex items-center justify-center">
                        <div class="absolute inset-0 bg-gradient-to-br from-brand-primary/20 to-brand-secondary/10 rounded-full group-hover:from-brand-primary/30 transition-all" style="animation: pulse 3s ease-in-out infinite;"></div>
                        <svg class="w-10 h-10 absolute" viewBox="0 0 40 40" fill="none" style="animation: spin 18s linear infinite;">
                            <circle cx="20" cy="20" r="18" stroke="url(#grad1)" stroke-width="1.5" opacity="0.3"/>
                            <circle cx="20" cy="3" r="2" fill="#6366f1"/>
                            <defs>
                                <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#0ea5e9;stop-opacity:0.3" />
                                </linearGradient>
                            </defs>
                        </svg>
                        <div class="relative w-6 h-6 rounded-full shadow-lg" style="background: linear-gradient(135deg, #6366f1, #0ea5e9);"></div>
                        <div class="absolute w-2 h-2 rounded-full bg-white" style="animation: blink 2.8s ease-in-out infinite;"></div>
                    </div>
                    <div>
                        <div class="text-xl font-bold tracking-tight brand-font bg-gradient-to-r from-brand-primary via-brand-secondary to-brand-accent bg-clip-text text-transparent">
                            It¬∑is¬∑YOU
                        </div>
                        <div class="text-[9px] text-slate-500 -mt-1 tracking-wider">PSYCHER ENGINE</div>
                    </div>
                </a>

                <!-- User Actions -->
                <div class="flex items-center gap-4">
                    <button onclick="window.location.href='/user-profile-tests.html'" class="px-4 py-2 text-sm text-slate-300 hover:text-white transition-colors">
                        Dashboard
                    </button>
                    
                    <!-- Theme Toggle -->
                    <button id="theme-toggle" class="theme-toggle" onclick="toggleTheme()" title="Prze≈ÇƒÖcz motyw">
                        <div class="theme-toggle-slider"></div>
                        <!-- Moon Icon (Dark Mode) -->
                        <svg class="theme-icon theme-icon-moon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                        <!-- Sun Icon (Light Mode) -->
                        <svg class="theme-icon theme-icon-sun" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                    </button>
                    
                    <button onclick="logout()" class="px-4 py-2 bg-bg-surface/50 hover:bg-bg-surface text-white rounded-lg text-sm border border-white/10 hover:border-brand-primary/50 transition-all backdrop-blur-sm">
                        Wyloguj
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="max-w-7xl mx-auto px-6 py-16">
        
        <!-- PROFILE HERO -->
        <div id="profile-hero" class="glass-panel rounded-3xl p-8 mb-12 border border-brand-primary/20 hover:border-brand-primary/40 transition-all duration-500 relative overflow-hidden" style="animation: fadeUp 0.8s ease-out;">
            <!-- Animated background gradient -->
            <div class="absolute inset-0 bg-gradient-to-br from-brand-primary/5 via-brand-secondary/5 to-brand-accent/5 opacity-50"></div>
            <div class="absolute -top-24 -right-24 w-64 h-64 bg-violet-500/10 rounded-full blur-3xl"></div>
            <div class="absolute -bottom-24 -left-24 w-64 h-64 bg-cyan-500/10 rounded-full blur-3xl"></div>
            
            <div class="relative z-10 flex flex-col lg:flex-row items-center lg:items-start gap-8">
                
                <!-- LEFT: Avatar & User Info -->
                <div class="flex flex-col items-center lg:flex-row lg:items-start gap-6 flex-shrink-0">
                    <!-- Avatar with Progress Ring -->
                    <div class="relative group">
                        <!-- SVG Progress Ring -->
                        <svg class="absolute inset-0 w-32 h-32 -rotate-90 transition-transform duration-700 group-hover:scale-110" viewBox="0 0 120 120">
                            <!-- Background ring -->
                            <circle cx="60" cy="60" r="54" fill="none" stroke="rgba(148, 163, 184, 0.1)" stroke-width="3"/>
                            <!-- Progress ring -->
                            <circle id="progress-ring" cx="60" cy="60" r="54" fill="none" stroke="url(#progressGradient)" stroke-width="3" stroke-linecap="round"
                                    stroke-dasharray="339.292" stroke-dashoffset="339.292" 
                                    style="transition: stroke-dashoffset 2s cubic-bezier(0.4, 0, 0.2, 1) 0.5s;">
                            </circle>
                            <!-- Glow effect -->
                            <circle id="progress-glow" cx="60" cy="60" r="54" fill="none" stroke="rgba(99, 102, 241, 0.4)" stroke-width="6" stroke-linecap="round"
                                    stroke-dasharray="339.292" stroke-dashoffset="339.292" 
                                    style="transition: stroke-dashoffset 2s cubic-bezier(0.4, 0, 0.2, 1) 0.5s; filter: blur(8px);">
                            </circle>
                            <defs>
                                <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
                                    <stop offset="50%" style="stop-color:#818cf8;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#0ea5e9;stop-opacity:1" />
                                </linearGradient>
                            </defs>
                        </svg>
                        
                        <!-- Avatar -->
                        <div id="user-avatar" class="relative w-32 h-32 rounded-full overflow-hidden border-4 border-bg-surface shadow-2xl group-hover:border-brand-primary/50 transition-all duration-500">
                            <!-- Gradient placeholder with initials -->
                            <div class="w-full h-full flex items-center justify-center" style="background: linear-gradient(135deg, #6366f1, #0ea5e9);">
                                <span id="user-initials" class="text-4xl font-bold text-white brand-font">?</span>
                            </div>
                        </div>
                        
                        <!-- Level indicator -->
                        <div class="absolute -bottom-2 left-1/2 -translate-x-1/2 px-3 py-1 rounded-full border-2 border-bg-main shadow-lg" style="background: linear-gradient(135deg, #6366f1, #4f46e5);">
                            <span id="profile-level" class="text-xs font-bold text-white">Lvl 0</span>
                        </div>
                    </div>
                    
                    <!-- User Data -->
                    <div class="text-center lg:text-left">
                        <h2 id="user-name" class="text-3xl font-bold text-white brand-font mb-2">≈Åadowanie...</h2>
                        <p id="user-email" class="text-slate-400 mb-4 text-sm">---</p>
                        
                        <!-- Premium Badge -->
                        <div id="premium-badge" class="inline-flex items-center gap-2 px-4 py-2 rounded-full border-2 transition-all duration-300">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                            </svg>
                            <span id="badge-text" class="text-xs font-bold uppercase tracking-wider">Free</span>
                        </div>
                    </div>
                </div>
                
                <!-- RIGHT: Stats & Progress -->
                <div class="flex-1 w-full">
                    <!-- Stats Header -->
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="text-2xl font-bold text-white brand-font mb-1">Postƒôp Profilu</h3>
                            <p class="text-slate-400 text-sm">Uko≈Ñcz wszystkie modu≈Çy aby odblokowaƒá pe≈ÇnƒÖ analizƒô</p>
                        </div>
                        <div class="text-right">
                            <div id="completion-count" class="text-4xl font-bold bg-clip-text text-transparent brand-font" style="background-image: linear-gradient(90deg, #6366f1, #0ea5e9); -webkit-background-clip: text;">0/7</div>
                            <p class="text-xs text-slate-500 uppercase tracking-wider">Modu≈Ç√≥w</p>
                        </div>
                    </div>
                    
                    <!-- Linear Progress Bar -->
                    <div class="relative h-4 bg-slate-800/50 rounded-full overflow-hidden mb-6 border border-slate-700/50">
                        <div id="progress-bar" class="absolute inset-y-0 left-0 rounded-full transition-all duration-1000 ease-out shadow-lg" style="background: linear-gradient(90deg, #6366f1, #0ea5e9);"
                             style="width: 0%; box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);">
                            <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 animate-pulse"></div>
                        </div>
                        <div id="progress-percentage" class="absolute inset-0 flex items-center justify-center text-xs font-bold text-white mix-blend-difference">0%</div>
                    </div>
                    
                    <!-- Next Step Recommendation -->
                    <div id="next-step-card" class="bg-slate-800/80 border border-violet-500/30 rounded-xl p-4 backdrop-blur-sm">
                        <div class="flex items-start gap-3">
                            <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-sm font-semibold text-brand-secondary mb-1 uppercase tracking-wide">Nastƒôpny Krok</h4>
                                <p id="next-step-text" class="text-slate-300 text-sm leading-relaxed">Rozpocznij pierwszy test aby zbudowaƒá sw√≥j profil psychometryczny</p>
                            </div>
                            <button id="next-step-button" onclick="startNextTest()" class="flex-shrink-0 px-4 py-2 text-white text-sm font-semibold rounded-lg transition-all shadow-glow-primary hover:scale-105" style="background: linear-gradient(135deg, #6366f1, #4f46e5); box-shadow: 0 0 15px -3px rgba(99,102,241,0.5);">
                                Start
                                <svg class="w-4 h-4 inline ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Completion Message (hidden by default) -->
                    <div id="completion-message" class="hidden bg-gradient-to-r from-emerald-900/20 to-green-900/20 border border-emerald-500/30 rounded-xl p-4 backdrop-blur-sm mt-4">
                        <div class="flex items-center gap-3">
                            <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-emerald-500 to-green-600 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-sm font-semibold text-emerald-300 mb-1">üéâ Profil Uko≈Ñczony!</h4>
                                <p class="text-slate-300 text-sm">Gratulacje! Uko≈Ñczy≈Çe≈õ wszystkie 7 modu≈Ç√≥w psychometrycznych.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module Section Header - Sci-Fi Separator -->
        <div class="flex items-center gap-4 mb-8" style="animation: fadeUp 1s ease-out;">
            <h2 class="text-sm font-semibold text-slate-500 uppercase tracking-widest whitespace-nowrap">Dostƒôpne Modu≈Çy (7)</h2>
            <div class="h-px bg-gradient-to-r from-slate-800 via-slate-700 to-transparent flex-grow"></div>
            <div class="flex gap-1">
                <div class="w-1 h-1 rounded-full bg-violet-500 animate-pulse"></div>
                <div class="w-1 h-1 rounded-full bg-purple-500 animate-pulse" style="animation-delay: 0.2s;"></div>
                <div class="w-1 h-1 rounded-full bg-cyan-500 animate-pulse" style="animation-delay: 0.4s;"></div>
            </div>
        </div>

        <!-- Test Cards Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">
            
            <!-- TEST 1: HEXACO-60 -->
            <div class="glass-card glass-card-active test-hexaco rounded-2xl p-6 cursor-pointer group" onclick="startHexacoTest()">
                <div class="flex items-center justify-between mb-5">
                    <div class="card-icon-wrapper">
                        <svg class="w-5 h-5 text-brand-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <span id="hexaco-status" class="neon-badge">
                        Do wykonania
                    </span>
                </div>
                
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-brand-primary transition-colors">HEXACO-60</h3>
                <p class="text-sm text-slate-400 mb-6">6 wymiar√≥w osobowo≈õci</p>
                
                <div class="flex items-center gap-2 text-xs text-slate-500 mb-6">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>15 min ¬∑ 60 pyta≈Ñ</span>
                </div>
                
                <button id="hexaco-button" class="btn-neural w-full">
                    Rozpocznij Test
                </button>
            </div>

            <!-- TEST 2: Enneagram -->
            <div class="glass-card glass-card-active test-enneagram rounded-2xl p-6 cursor-pointer group" onclick="startEnneagramTest()">
                <div class="flex items-center justify-between mb-5">
                    <div class="card-icon-wrapper">
                        <svg class="w-5 h-5 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <span id="enneagram-status" class="neon-badge">
                        Do wykonania
                    </span>
                </div>
                
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-pink-400 transition-colors">Enneagram</h3>
                <p class="text-sm text-slate-400 mb-6">Motywacja - Typy 1-9</p>
                
                <div class="flex items-center gap-2 text-xs text-slate-500 mb-6">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>10 min ¬∑ 36 pyta≈Ñ</span>
                </div>
                
                <button id="enneagram-button" class="btn-neural w-full">
                    Rozpocznij Test
                </button>
            </div>

            <!-- TEST 3: Dark Triad -->
            <div class="glass-card glass-card-active test-dark-triad rounded-2xl p-6 cursor-pointer group" onclick="startDarkTriadTest()">
                <div class="flex items-center justify-between mb-5">
                    <div class="card-icon-wrapper">
                        <svg class="w-5 h-5 text-rose-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                    </div>
                    <span id="dark-triad-status" class="neon-badge">
                        Do wykonania
                    </span>
                </div>
                
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-rose-400 transition-colors">Dark Triad SD3</h3>
                <p class="text-sm text-slate-400 mb-6">Cie≈Ñ / Ryzyka</p>
                
                <div class="flex items-center gap-2 text-xs text-slate-500 mb-6">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>8 min ¬∑ 27 pyta≈Ñ</span>
                </div>
                
                <button id="dark-triad-button" class="btn-neural w-full">
                    Zbadaj Cie≈Ñ
                </button>
            </div>

            <!-- TEST 4: Strengths -->
            <div class="glass-card glass-card-active test-strengths rounded-2xl p-6" onclick="startStrengthsTest()" style="cursor: pointer;">
                <div class="flex items-center justify-between mb-5 relative z-10">
                    <div class="card-icon-wrapper">
                        <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <span id="strengths-status" class="neon-badge neon-badge-available">Dostƒôpny</span>
                </div>
                
                <h3 class="text-xl font-bold text-white mb-2 relative z-10">Strengths Assessment</h3>
                <p class="text-sm text-slate-400 mb-6 relative z-10">Talenty - Top 5</p>
                
                <div class="flex items-center gap-2 text-xs text-slate-500 mb-6 relative z-10">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>12 min ¬∑ 48 pyta≈Ñ</span>
                </div>
                
                <button id="strengths-button" class="btn-neural w-full relative z-10">
                    Odkryj Talenty
                </button>
            </div>

            <!-- TEST 5: Career Interests -->
            <div class="glass-card glass-card-active test-career rounded-2xl p-6" onclick="startCareerTest()" style="cursor: pointer;">
                <div class="flex items-center justify-between mb-5 relative z-10">
                    <div class="card-icon-wrapper">
                        <svg class="w-5 h-5 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                       </svg>
                    </div>
                    <span id="career-status" class="neon-badge neon-badge-available">Dostƒôpny</span>
                </div>
                
                <h3 class="text-xl font-bold text-white mb-2 relative z-10">Career Interests RIASEC</h3>
                <p class="text-sm text-slate-400 mb-6 relative z-10">Holland Code</p>
                
                <div class="flex items-center gap-2 text-xs text-slate-500 mb-6 relative z-10">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>12 min ¬∑ 48 pyta≈Ñ</span>
                </div>
                
                <button id="career-button" class="btn-neural w-full relative z-10">
                    Odkryj Kod Hollanda
                </button>
            </div>

            <!-- TEST 6: Values Schwartz -->
            <div class="glass-card glass-card-active test-values rounded-2xl p-6 cursor-pointer group" onclick="startValuesTest()">
                <div class="flex items-center justify-between mb-5 relative z-10">
                    <div class="card-icon-wrapper">
                        <svg class="w-5 h-5 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path>
                        </svg>
                    </div>
                    <span id="values-status" class="neon-badge">Dostƒôpny</span>
                </div>
                
                <h3 class="text-xl font-bold text-white mb-2 relative z-10">Warto≈õci Osobiste</h3>
                <p class="text-sm text-slate-400 mb-6 relative z-10">Schwartz PVQ - Co jest dla Ciebie wa≈ºne</p>
                
                <div class="flex items-center gap-2 text-xs text-slate-500 mb-6 relative z-10">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>10 min ¬∑ 40 pyta≈Ñ</span>
                </div>
                
                <button id="values-button" class="btn-neural w-full relative z-10">
                    Rozpocznij Test
                </button>
            </div>



        </div>

        <!-- Info Section -->
        <div class="mt-20 glass-card rounded-3xl p-10 border border-violet-500/20 relative overflow-hidden">
            <!-- Glow effect -->
            <div class="absolute top-0 left-1/2 -translate-x-1/2 w-96 h-96 bg-violet-500/10 rounded-full blur-3xl"></div>
            
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-8 brand-font text-center relative">
                <span class="bg-clip-text text-transparent" style="background-image: linear-gradient(90deg, #6366f1, #0ea5e9, #d946ef); -webkit-background-clip: text;">
                    Jak to dzia≈Ça?
                </span>
            </h2>
            <div class="grid md:grid-cols-3 gap-8 text-slate-300 relative">
                <div class="text-center">
                    <div class="text-5xl mb-4 filter drop-shadow-lg">üìù</div>
                    <h3 class="font-bold text-white mb-3 text-lg">1. Wype≈Çnij Testy</h3>
                    <p class="text-sm text-slate-400 leading-relaxed">Odpowiedz szczerze na pytania w ka≈ºdym te≈õcie. Nie ma z≈Çych odpowiedzi.</p>
                </div>
                <div class="text-center">
                    <div class="text-5xl mb-4 filter drop-shadow-lg">üß†</div>
                    <h3 class="font-bold text-white mb-3 text-lg">2. Otrzymaj Wyniki</h3>
                    <p class="text-sm text-slate-400 leading-relaxed">Natychmiast po zako≈Ñczeniu zobaczysz szczeg√≥≈ÇowƒÖ analizƒô swoich wynik√≥w.</p>
                </div>
                <div class="text-center">
                    <div class="text-5xl mb-4 filter drop-shadow-lg">üé≠</div>
                    <h3 class="font-bold text-white mb-3 text-lg">3. Odkryj Siebie</h3>
                    <p class="text-sm text-slate-400 leading-relaxed">Zbudujemy TwojƒÖ unikalnƒÖ Kartƒô Postaci na podstawie wszystkich test√≥w.</p>
                </div>
            </div>
        </div>

    </main>

    <!-- FOOTER -->
    <footer class="border-t border-white/5 bg-black/30 backdrop-blur-xl mt-24">
        <div class="max-w-7xl mx-auto px-6 py-10 text-center">
            <p class="text-slate-500 text-sm">
               &copy; 2026 <span class="text-brand-primary font-semibold">It Is You</span> - Psycher Engine. Wszystkie prawa zastrze≈ºone.
            </p>
        </div>
    </footer>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';

        const supabaseUrl = 'https://uvzilorpyuqicuwkufky.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV2emlsb3JweXVxaWN1d2t1Zmt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzNDQzNTAsImV4cCI6MjA4NjkyMDM1MH0.jNIkqASHNl_7WbLq0jBZ86kRDmRP2jzIbI-db9l9teA';
        const supabase = createClient(supabaseUrl, supabaseKey);

        console.log('Dashboard loaded, Supabase client created');
        
        // ============================================
        // THEME TOGGLE FUNCTIONALITY
        // ============================================
        
        // Load theme preference on page load
        function loadThemePreference() {
            const savedTheme = localStorage.getItem('theme');
            const toggle = document.getElementById('theme-toggle');
            
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                if (toggle) toggle.classList.add('light');
            }
            
            console.log('Theme loaded:', savedTheme || 'dark (default)');
        }
        
        // Toggle theme function
        window.toggleTheme = function() {
            const body = document.body;
            const toggle = document.getElementById('theme-toggle');
            const isLightMode = body.classList.contains('light-mode');
            
            if (isLightMode) {
                // Switch to Dark Mode
                body.classList.remove('light-mode');
                toggle.classList.remove('light');
                localStorage.setItem('theme', 'dark');
                console.log('Switched to Dark Mode');
            } else {
                // Switch to Light Mode
                body.classList.add('light-mode');
                toggle.classList.add('light');
                localStorage.setItem('theme', 'light');
                console.log('Switched to Light Mode');
            }
        }
        
        // Load theme immediately (before other scripts)
        loadThemePreference();
        
        // ============================================
        // END THEME TOGGLE
        // ============================================
        
        // Debug: Check localStorage keys
        console.log('LocalStorage keys:', Object.keys(localStorage));
        const supabaseKeys = Object.keys(localStorage).filter(k => k.includes('supabase') || k.includes('sb-'));
        console.log('Supabase-related keys:', supabaseKeys);
        supabaseKeys.forEach(key => {
            const value = localStorage.getItem(key);
            console.log(`  ${key}:`, value?.substring(0, 100) + '...');
        });

        // Check authentication
        async function checkAuth() {
            console.log('Checking auth...');
            // Wait for Supabase to restore session from localStorage
            const { data: { session }, error } = await supabase.auth.getSession();
            
            console.log('Session check:', { session: session ? 'exists' : 'null', error, userId: session?.user?.id });
            
            if (error || !session) {
                console.log('No valid session, redirecting to auth');
                window.location.href = '/auth';
                return false;
            }
            
            console.log('User authenticated:', session.user.id);
            return true;
        }

        // Logout function
        window.logout = function() {
            localStorage.removeItem('user_session');
            localStorage.removeItem('auth_token');
            localStorage.removeItem('has_profile');
            window.location.href = 'https://it-is-you1.vercel.app/';
        }

        // Check if Strengths test is completed
        async function checkStrengthsCompleted() {
            try {
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session || !session.user) {
                    return false;
                }

                const { data, error } = await supabase
                    .from('user_psychometrics')
                    .select('*')
                    .eq('user_id', session.user.id)
                    .eq('test_type', 'STRENGTHS')
                    .order('completed_at', { ascending: false })
                    .limit(1);

                if (error) {
                    console.error('Error checking Strengths completion:', error);
                    return false;
                }

                return data && data.length > 0;
            } catch (err) {
                console.error('Error in checkStrengthsCompleted:', err);
                return false;
            }
        }

        // Check if Career test is completed
        async function checkCareerCompleted() {
            try {
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session || !session.user) {
                    return false;
                }

                const { data, error } = await supabase
                    .from('user_psychometrics')
                    .select('*')
                    .eq('user_id', session.user.id)
                    .eq('test_type', 'CAREER')
                    .order('completed_at', { ascending: false })
                    .limit(1);

                if (error) {
                    console.error('Error checking Career completion:', error);
                    return false;
                }

                return data && data.length > 0;
            } catch (err) {
                console.error('Error in checkCareerCompleted:', err);
                return false;
            }
        }

        // Check if Values test is completed
        async function checkValuesCompleted() {
            try {
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session || !session.user) {
                    return false;
                }

                const { data, error } = await supabase
                    .from('user_psychometrics')
                    .select('*')
                    .eq('user_id', session.user.id)
                    .eq('test_type', 'VALUES')
                    .order('completed_at', { ascending: false })
                    .limit(1);

                if (error) {
                    console.error('Error checking Values completion:', error);
                    return false;
                }

                return data && data.length > 0;
            } catch (err) {
                console.error('Error in checkValuesCompleted:', err);
                return false;
            }
        }

        // Check if Dark Triad test is completed
        async function checkDarkTriadCompleted() {
            try {
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session || !session.user) {
                    return false;
                }

                const { data, error } = await supabase
                    .from('user_psychometrics')
                    .select('*')
                    .eq('user_id', session.user.id)
                    .eq('test_type', 'DARK_TRIAD')
                    .order('completed_at', { ascending: false })
                    .limit(1);

                if (error) {
                    console.error('Error checking Dark Triad completion:', error);
                    return false;
                }

                return data && data.length > 0;
            } catch (err) {
                console.error('Error in checkDarkTriadCompleted:', err);
                return false;
            }
        }

        // Check if Enneagram test is completed
        async function checkEnneagramCompleted() {
            try {
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session || !session.user) {
                    return false;
                }

                const { data, error } = await supabase
                    .from('user_psychometrics')
                    .select('*')
                    .eq('user_id', session.user.id)
                    .eq('test_type', 'ENNEAGRAM')
                    .order('completed_at', { ascending: false })
                    .limit(1);

                if (error) {
                    console.error('Error checking Enneagram completion:', error);
                    return false;
                }

                return data && data.length > 0;
            } catch (err) {
                console.error('Error in checkEnneagramCompleted:', err);
                return false;
            }
        }

        // Check if HEXACO test is completed
        async function checkHexacoCompleted() {
            try {
                // First restore the session from localStorage
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError) {
                    console.error('Session error:', sessionError);
                    return false;
                }
                
                if (!session || !session.user) {
                    console.log('No active session found');
                    return false;
                }

                console.log('Checking test completion for user:', session.user.id);

                const { data, error } = await supabase
                    .from('user_psychometrics')
                    .select('*')
                    .eq('user_id', session.user.id)
                    .eq('test_type', 'HEXACO')
                    .order('completed_at', { ascending: false })
                    .limit(1);

                console.log('Database query result:', { data, error, count: data?.length });

                if (error) {
                    console.error('Error checking test completion:', error);
                    return false;
                }

                const completed = data && data.length > 0;
                console.log('HEXACO test completed:', completed);
                if (completed) {
                    console.log('Test details:', data[0]);
                }
                return completed;
            } catch (err) {
                console.error('Error in checkHexacoCompleted:', err);
                return false;
            }
        }

        // Start Strengths test or view results
        window.startStrengthsTest = async function() {
            const completed = await checkStrengthsCompleted();
            
            if (completed) {
                window.location.href = '/test/strengths/results';
            } else {
                window.location.href = '/test?type=strengths';
            }
        }

        // Start Career test or view results
        window.startCareerTest = async function() {
            const completed = await checkCareerCompleted();
            
            if (completed) {
                window.location.href = '/test/career/results';
            } else {
                window.location.href = '/test?type=career';
            }
        }

        // Start Values test or view results
        window.startValuesTest = async function() {
            const completed = await checkValuesCompleted();
            
            if (completed) {
                window.location.href = '/test/values/results';
            } else {
                window.location.href = '/test?type=values';
            }
        }

        // Start Dark Triad test or view results
        window.startDarkTriadTest = async function() {
            const completed = await checkDarkTriadCompleted();
            
            if (completed) {
                window.location.href = '/test/dark-triad/results';
            } else {
                window.location.href = '/test?type=dark_triad';
            }
        }

        // Start Enneagram test or view results
        window.startEnneagramTest = async function() {
            const completed = await checkEnneagramCompleted();
            
            if (completed) {
                window.location.href = '/test/enneagram/results';
            } else {
                window.location.href = '/test?type=enneagram';
            }
        }

        // Start HEXACO test or view results
        window.startHexacoTest = async function() {
            console.log('HEXACO tile clicked, checking completion status...');
            const completed = await checkHexacoCompleted();
            console.log('Completion check result:', completed);
            
            if (completed) {
                console.log('Test completed, redirecting to results');
                window.location.href = '/test/hexaco/results';
            } else {
                console.log('Test not completed, redirecting to test');
                window.location.href = '/test';
            }
        }

        // Update UI for Strengths test
        async function updateStrengthsUI() {
            const completed = await checkStrengthsCompleted();
            
            const statusEl = document.getElementById('strengths-status');
            const buttonEl = document.getElementById('strengths-button');
            
            if (completed) {
                if (statusEl) {
                    statusEl.textContent = 'Uko≈Ñczony';
                    statusEl.className = 'neon-badge neon-badge-success';
                }
                if (buttonEl) {
                    buttonEl.innerHTML = '<svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>Zobacz Wynik';
                    buttonEl.className = 'w-full px-4 py-3 bg-transparent border border-white/10 text-slate-400 hover:bg-white/5 hover:text-white font-semibold rounded-xl transition-all relative z-10';
                }
            }
        }

        // Update UI for Career test
        async function updateCareerUI() {
            const completed = await checkCareerCompleted();
            
            const statusEl = document.getElementById('career-status');
            const buttonEl = document.getElementById('career-button');
            
            if (completed) {
                if (statusEl) {
                    statusEl.textContent = 'Uko≈Ñczony';
                    statusEl.className = 'neon-badge neon-badge-success';
                }
                if (buttonEl) {
                    buttonEl.innerHTML = '<svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>Zobacz Wynik';
                    buttonEl.className = 'w-full px-4 py-3 bg-transparent border border-white/10 text-slate-400 hover:bg-white/5 hover:text-white font-semibold rounded-xl transition-all relative z-10';
                }
            }
        }

        // Update UI for Values test
        async function updateValuesUI() {
            const completed = await checkValuesCompleted();
            
            const statusEl = document.getElementById('values-status');
            const buttonEl = document.getElementById('values-button');
            
            if (completed) {
                if (statusEl) {
                    statusEl.textContent = 'Uko≈Ñczony';
                    statusEl.className = 'neon-badge neon-badge-success';
                }
                if (buttonEl) {
                    buttonEl.innerHTML = '<svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>Zobacz Wynik';
                    buttonEl.className = 'w-full px-4 py-3 bg-transparent border border-white/10 text-slate-400 hover:bg-white/5 hover:text-white font-semibold rounded-xl transition-all relative z-10';
                }
            }
        }

        // Update UI for Dark Triad test
        async function updateDarkTriadUI() {
            const completed = await checkDarkTriadCompleted();
            
            const statusEl = document.getElementById('dark-triad-status');
            const buttonEl = document.getElementById('dark-triad-button');
            
            if (completed) {
                if (statusEl) {
                    statusEl.textContent = 'Uko≈Ñczony';
                    statusEl.className = 'neon-badge neon-badge-success';
                }
                if (buttonEl) {
                    buttonEl.innerHTML = '<svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>Zobacz Wynik';
                    buttonEl.className = 'w-full px-4 py-3 bg-transparent border border-white/10 text-slate-400 hover:bg-white/5 hover:text-white font-semibold rounded-xl transition-all';
                }
            }
        }

        // Update UI for Enneagram test
        async function updateEnneagramUI() {
            const completed = await checkEnneagramCompleted();
            
            const statusEl = document.getElementById('enneagram-status');
            const buttonEl = document.getElementById('enneagram-button');
            
            if (completed) {
                if (statusEl) {
                    statusEl.textContent = 'Uko≈Ñczony';
                    statusEl.className = 'neon-badge neon-badge-success';
                }
                if (buttonEl) {
                    buttonEl.innerHTML = '<svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>Zobacz Wynik';
                    buttonEl.className = 'w-full px-4 py-3 bg-transparent border border-white/10 text-slate-400 hover:bg-white/5 hover:text-white font-semibold rounded-xl transition-all';
                }
            }
        }

        // Update UI based on test completion status
        async function updateHexacoUI() {
            console.log('Updating HEXACO UI...');
            const completed = await checkHexacoCompleted();
            console.log('Test completed status:', completed);
            
            const statusEl = document.getElementById('hexaco-status');
            const buttonEl = document.querySelector('#hexaco-button');
            
            console.log('Status element:', statusEl, 'Button element:', buttonEl);
            
            if (completed) {
                if (statusEl) {
                    statusEl.textContent = 'Uko≈Ñczony';
                    statusEl.className = 'neon-badge neon-badge-success';
                }
                if (buttonEl) {
                    buttonEl.innerHTML = '<svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>Zobacz Wynik';
                    buttonEl.className = 'w-full px-4 py-3 bg-transparent border border-white/10 text-slate-400 hover:bg-white/5 hover:text-white font-semibold rounded-xl transition-all';
                }
                console.log('UI updated to show completed state');
            } else {
                console.log('Test not completed, keeping default UI');
            }
        }

        // Initialize when DOM is ready
        async function initialize() {
            console.log('Initializing dashboard...');
            const authenticated = await checkAuth();
            if (!authenticated) {
                console.log('Not authenticated, stopping initialization');
                return;
            }
            console.log('Auth successful, updating UI...');
            await updateProfileHero();
            await updateHexacoUI();
            await updateEnneagramUI();
            await updateDarkTriadUI();
            await updateStrengthsUI();
            await updateCareerUI();
            await updateValuesUI();
            console.log('Dashboard initialized successfully');
        }

        // ============================================
        // PROFILE HERO FUNCTIONS
        // ============================================

        // Count all completed tests
        async function getCompletedTestsCount() {
            try {
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session || !session.user) {
                    return 0;
                }

                const { data, error } = await supabase
                    .from('user_psychometrics')
                    .select('test_type')
                    .eq('user_id', session.user.id);

                if (error) {
                    console.error('Error counting completed tests:', error);
                    return 0;
                }

                // Get unique test types (in case user retook a test)
                const uniqueTests = [...new Set(data.map(item => item.test_type))];
                return uniqueTests.length;
            } catch (err) {
                console.error('Error in getCompletedTestsCount:', err);
                return 0;
            }
        }

        // Get next recommended test
        async function getNextTest() {
            const tests = [
                { name: 'HEXACO-60', type: 'hexaco', checkFn: checkHexacoCompleted, startFn: 'startHexacoTest' },
                { name: 'Enneagram', type: 'enneagram', checkFn: checkEnneagramCompleted, startFn: 'startEnneagramTest' },
                { name: 'Dark Triad', type: 'dark_triad', checkFn: checkDarkTriadCompleted, startFn: 'startDarkTriadTest' },
                { name: 'Character Strengths', type: 'strengths', checkFn: checkStrengthsCompleted, startFn: 'startStrengthsTest' },
                { name: 'Career Interests', type: 'career', checkFn: checkCareerCompleted, startFn: 'startCareerTest' },
                { name: 'Personal Values', type: 'values', checkFn: checkValuesCompleted, startFn: 'startValuesTest' }
            ];

            for (const test of tests) {
                const completed = await test.checkFn();
                if (!completed) {
                    return test;
                }
            }

            return null; // All tests completed
        }

        // Start next recommended test
        window.startNextTest = async function() {
            const nextTest = await getNextTest();
            if (nextTest) {
                window[nextTest.startFn]();
            }
        }

        // Update Profile Hero UI
        async function updateProfileHero() {
            try {
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();
                
                if (sessionError || !session || !session.user) {
                    console.error('No session for profile hero');
                    return;
                }

                const user = session.user;
                const completedCount = await getCompletedTestsCount();
                const totalTests = 7;
                const percentage = Math.round((completedCount / totalTests) * 100);
                const nextTest = await getNextTest();

                // Update user info
                const userName = user.user_metadata?.full_name || user.email?.split('@')[0] || 'Anonymous';
                const userInitials = userName.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                
                document.getElementById('user-name').textContent = userName;
                document.getElementById('user-email').textContent = user.email;
                document.getElementById('user-initials').textContent = userInitials;

                // Update level (based on completed tests)
                const level = completedCount;
                document.getElementById('profile-level').textContent = `Lvl ${level}`;

                // Update completion stats
                document.getElementById('completion-count').textContent = `${completedCount}/${totalTests}`;
                document.getElementById('progress-percentage').textContent = `${percentage}%`;

                // Animate progress bar
                setTimeout(() => {
                    document.getElementById('progress-bar').style.width = `${percentage}%`;
                }, 300);

                // Update SVG progress ring (circumference = 2 * PI * r = 2 * 3.14159 * 54 ‚âà 339.292)
                const circumference = 339.292;
                const offset = circumference - (percentage / 100) * circumference;
                
                setTimeout(() => {
                    document.getElementById('progress-ring').style.strokeDashoffset = offset;
                    document.getElementById('progress-glow').style.strokeDashoffset = offset;
                }, 500);

                // Update Premium badge (placeholder - could be based on actual premium status)
                const isPremium = false; // TODO: Get from database or user metadata
                const badge = document.getElementById('premium-badge');
                const badgeText = document.getElementById('badge-text');
                
                if (isPremium) {
                    badge.className = 'inline-flex items-center gap-2 px-4 py-2 rounded-full border-2 border-amber-500 bg-gradient-to-r from-amber-500/20 to-yellow-500/20 shadow-lg shadow-amber-500/20';
                    badge.style.color = '#FCD34D';
                    badgeText.textContent = '‚ú® Premium';
                } else {
                    badge.className = 'inline-flex items-center gap-2 px-4 py-2 rounded-full border-2 border-slate-600 bg-slate-800/30';
                    badge.style.color = '#94A3B8';
                    badgeText.textContent = 'Free Account';
                }

                // Update Next Step recommendation
                const nextStepCard = document.getElementById('next-step-card');
                const nextStepText = document.getElementById('next-step-text');
                const nextStepButton = document.getElementById('next-step-button');
                const completionMessage = document.getElementById('completion-message');

                if (nextTest) {
                    nextStepCard.classList.remove('hidden');
                    completionMessage.classList.add('hidden');
                    nextStepText.textContent = `Rekomendowany krok: Wykonaj test "${nextTest.name}"`;
                    nextStepButton.classList.remove('hidden');
                } else {
                    // All tests completed!
                    nextStepCard.classList.add('hidden');
                    completionMessage.classList.remove('hidden');
                }

                console.log('Profile Hero updated:', { completedCount, percentage, nextTest: nextTest?.name });
            } catch (err) {
                console.error('Error updating Profile Hero:', err);
            }
        }

        // ============================================
        // END PROFILE HERO FUNCTIONS
        // ============================================

        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initialize);
        } else {
            initialize();
        }
    </script>

</body>
</html>
